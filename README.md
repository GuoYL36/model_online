# model_online
> Some methods of model deploy online

## 主要分传统机器学习模型部署和深度学习模型部署
+ 路径
    + 机器学习模型部署
        + tornado框架部署
            + lightgbm模型
		+ flask框架部署
			+ tensorflow模型
    + tensorflow部署
        + 跨语言API方式
            + client_api
        + 跨平台PMML方式
        + tensorflow serving方式

## 线上
> 参考：https://mp.weixin.qq.com/s/IAWO5C4WRSC6Qu6ffsdbig
### 要求
+ 保持线上与线下逻辑一致
	+ 线上数据清洗和特征提取流程与线下一致，使用同一套代码；
	+ 由于线上数据是json格式，线下处理时最好保持输入是json格式数据
+ 模型分数预测
	+ 要求线上与线下测试100%一致，理论上小数点后10位要一模一样
	+ 线上测试效率要求1条数据需要在200—500ms内返回
+ 实时模型监控
	+ 数据特征监控
		+ 有数据异常时，便于定位问题
	+ 模型状态监控
		+ 模型在预测过程中可能会出现一些意想不到的情况，比如网络延时导致的效率低、输出有问题等，都需要记录下来
	+ 模型分数监控
		+ 监控模型分数的分布（PSI指标）
		+ 推荐设定预警系统

### 问题
+ 线上json缺少特征，如何处理？
	+ 返回“数据错误”
+ 线上与线下分数预测不一致
	+ 保证线上与线下逻辑的一致性；
	+ 如果线上与线下逻辑一致，则从以下几点考虑
		+ 机器的精度
		+ 在gpu上训练，在cpu上测试
		+ python包版本不一致
		+ 特征有存储后读出的逻辑使得精度改变
		

